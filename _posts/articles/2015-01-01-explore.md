---
layout: post
title: "Exploration of HHS Dataset"
date: 2015-01-01
categories: articles
tags: [data science]
---


### Loading Data


{% highlight r %}
load('/Users/abrooks/Box Sync/Andrew Brooks/hhs/data/hhs.Rdata')
d <- data
rm(data)
{% endhighlight %}

### Basic univariate plots

The first step I took to get a feel for this relatively wide (234 columns) dataset was to plot each variable univariately.  See accompanying plotsdf.pdf which contains 234 pages, one for each variable with basic plots and summary stats.

### Summary stats
Messy code, but gets the job done.  There are good amount of variables with missing data.  


{% highlight r %}
a1 <- data.frame(sapply(d, class))
a1$v <- rownames(a1)

a2 <- data.frame(sapply(d, function(x) length(unique(x))))
a2$v <- rownames(a2)

a3 <- data.frame(sapply(d, function(x) sum(is.na(x))))
a3$v <- rownames(a3)

a <- merge(a1, a2, by='v')
a <- merge(a, a3, by='v')
names(a) <- c('v', 'class', 'unique', 'missing')

print(a)
{% endhighlight %}



{% highlight text %}
##                                  v     class unique missing
## 1                           Action character      8       0
## 2                Announcement_Code character      2       0
## 3                  APR_Tot_Charges   numeric   3953     402
## 4                  AUG_Tot_Charges   numeric   3931     402
## 5                           Branch character     21       0
## 6                              CEO character   2608       0
## 7                        CEO_Email character   1719       0
## 8                   CEO_Email_prev character   1719       0
## 9                   ClinicDirEmail character   1933       0
## 10             ClinicDirEmail_prev character   1933       0
## 11                     Cost_Per_Pt   numeric   4645       8
## 12                Cost_Per_Pt_prev   numeric   4645       8
## 13        count_120_30_stat_active   numeric      3    4616
## 14  count_120_30_stat_admin_closed   numeric      3    4616
## 15      count_120_30_stat_approved   numeric      3    4616
## 16   count_120_30_stat_disapproved   numeric      3    4616
## 17           count_120_30_stat_met   numeric      6    4616
## 18        count_120_60_stat_active   numeric      5    4402
## 19  count_120_60_stat_admin_closed   numeric      3    4402
## 20      count_120_60_stat_approved   numeric      3    4402
## 21     count_120_60_stat_defaulted   numeric      6    4402
## 22   count_120_60_stat_disapproved   numeric      3    4402
## 23           count_120_60_stat_met   numeric      8    4402
## 24   count_120_Condition_Require_N   numeric     10    2735
## 25   count_120_Condition_Require_Y   numeric     19    2735
## 26           count_120_stat_active   numeric     10    3854
## 27     count_120_stat_admin_closed   numeric      3    3854
## 28         count_120_stat_approved   numeric      5    3854
## 29        count_120_stat_defaulted   numeric      9    3854
## 30      count_120_stat_disapproved   numeric      3    3854
## 31              count_120_stat_met   numeric     12    3854
## 32      count_120_stat_transferred   numeric      3    3854
## 33      count_120_stat_unsatisfied   numeric      3    3854
## 34            count_30_stat_active   numeric      5    4385
## 35          count_30_stat_approved   numeric      3    4385
## 36               count_30_stat_met   numeric     13    4385
## 37            count_60_stat_active   numeric      8    3776
## 38      count_60_stat_admin_closed   numeric      3    3776
## 39          count_60_stat_approved   numeric      4    3776
## 40         count_60_stat_defaulted   numeric     13    3776
## 41       count_60_stat_disapproved   numeric      3    3776
## 42               count_60_stat_met   numeric     12    3776
## 43            count_90_stat_active   numeric      8    2744
## 44      count_90_stat_admin_closed   numeric      3    2744
## 45          count_90_stat_approved   numeric      6    2744
## 46         count_90_stat_defaulted   numeric     18    2744
## 47       count_90_stat_disapproved   numeric      4    2744
## 48               count_90_stat_met   numeric     18    2744
## 49                count_condition0   numeric      3    2735
## 50                count_condition1   numeric      4    2735
## 51               count_condition10   numeric      4    2735
## 52               count_condition11   numeric      6    2735
## 53               count_condition12   numeric      6    2735
## 54               count_condition13   numeric      6    2735
## 55               count_condition14   numeric      4    2735
## 56               count_condition15   numeric      4    2735
## 57               count_condition16   numeric      5    2735
## 58               count_condition17   numeric      4    2735
## 59               count_condition18   numeric      4    2735
## 60               count_condition19   numeric      6    2735
## 61                count_condition2   numeric      4    2735
## 62               count_condition20   numeric      4    2735
## 63                count_condition3   numeric      3    2735
## 64                count_condition4   numeric      4    2735
## 65                count_condition5   numeric      5    2735
## 66                count_condition6   numeric      5    2735
## 67                count_condition7   numeric      6    2735
## 68                count_condition8   numeric      4    2735
## 69                count_condition9   numeric      3    2735
## 70       count_Restriction_Reason1   numeric      3      50
## 71      count_Restriction_Reason10   numeric      3      50
## 72       count_Restriction_Reason2   numeric      3      50
## 73       count_Restriction_Reason3   numeric      3      50
## 74       count_Restriction_Reason4   numeric      3      50
## 75       count_Restriction_Reason5   numeric      3      50
## 76       count_Restriction_Reason6   numeric      3      50
## 77       count_Restriction_Reason7   numeric      3      50
## 78       count_Restriction_Reason8   numeric      3      50
## 79       count_Restriction_Reason9   numeric      3      50
## 80          count_review_stat_dgmo   numeric      7    2737
## 81       count_review_stat_grantee   numeric      9    2737
## 82        count_review_stat_lifted   numeric     21    2737
## 83            count_review_stat_pa   numeric      6    2737
## 84           count_review_stat_sub   numeric      9    2737
## 85          count_source_off_cycle   numeric     21    2735
## 86                count_source_par   numeric     18    2735
## 87             count_status_active   numeric     14    2735
## 88       count_status_admin_closed   numeric      2    2735
## 89           count_status_approved   numeric      6    2735
## 90          count_status_defaulted   numeric      6    2735
## 91        count_status_disapproved   numeric      5    2735
## 92                count_status_met   numeric     21    2735
## 93        count_status_transferred   numeric      3    2735
## 94        count_status_unsatisfied   numeric      3    2735
## 95                 DEC_Tot_Charges   numeric   3897     402
## 96                      Default_PO character    120       0
## 97                        Defunded   numeric      2       0
## 98                   defunded_ever   numeric      2       0
## 99               defunded_ever_bad   numeric      2       0
## 100               Disbursed_Amount   numeric   3658     402
## 101                       Division character      5       0
## 102                 drawdown_alert   numeric      3      50
## 103                       Duration   numeric      4    3755
## 104                            EHR   numeric      3    1131
## 105                    EHR_for_UDS   numeric      3    1533
## 106                         ein_no character   1220       0
## 107                FEB_Tot_Charges   numeric   3518     402
## 108             Funding_Cycle_Name character      4       0
## 109                     FundingCHC   numeric      2       0
## 110                      FundingHO   numeric      2       0
## 111                     FundingMHC   numeric      2       0
## 112                      FundingPH   numeric      2       0
## 113                       Grant_No character   1231       0
## 114                         HCCity character    989       0
## 115                         HCName character   1788       0
## 116                        HCState character     59       0
## 117                          HCZip character   1381       0
## 118          In_Effect_Auth_Amount   numeric   3596     402
## 119                 Ind_Accredited   numeric      3    1731
## 120              Ind_Active_Status   numeric      3       1
## 121                  Ind_Condition   numeric      3    2735
## 122                   Ind_Finding1   numeric      3     710
## 123                  Ind_Finding10   numeric      3     710
## 124                  Ind_Finding11   numeric      3     710
## 125                  Ind_Finding12   numeric      3     710
## 126                   Ind_Finding2   numeric      3     710
## 127                   Ind_Finding3   numeric      3     710
## 128                   Ind_Finding4   numeric      3     710
## 129                   Ind_Finding5   numeric      3     710
## 130                   Ind_Finding6   numeric      3     710
## 131                   Ind_Finding7   numeric      3     710
## 132                   Ind_Finding8   numeric      3     710
## 133                   Ind_Finding9   numeric      3     710
## 134                   ind_first_yr   numeric      2       0
## 135              Ind_Going_Concern   numeric      3    1194
## 136              Ind_Major_Program   numeric      3     710
## 137    Ind_Material_Non_Compliance   numeric      3    1337
## 138                       Ind_PCMH   numeric      3    1731
## 139                JAN_Tot_Charges   numeric   3825     402
## 140                JUL_Tot_Charges   numeric   4055     402
## 141                JUN_Tot_Charges   numeric   3986     402
## 142                MAR_Tot_Charges   numeric   3957     402
## 143                MAY_Tot_Charges   numeric   3805     402
## 144                  Mid_Level_FTE   numeric   1542       0
## 145             Mid_Level_FTE_prev   numeric   1542       0
## 146               Mid_Level_Visits   numeric   4204       0
## 147          Mid_Level_Visits_prev   numeric   4204       0
## 148                  NAP_Indicator   numeric      2    3755
## 149                NOV_Tot_Charges   numeric   3844     402
## 150                      Nurse_FTE   numeric   2023       0
## 151                 Nurse_FTE_prev   numeric   2023       0
## 152                   Nurse_Visits   numeric   2291       0
## 153              Nurse_Visits_prev   numeric   2291       0
## 154                OCT_Tot_Charges   numeric   3978     402
## 155                    Oth_Med_FTE   numeric   2285       0
## 156                        overall   numeric      1       0
## 157                  OverallRating   numeric      3    1131
## 158         pct_change_BHPC_Grants   numeric   3372    1264
## 159         pct_change_Cost_Per_Pt   numeric   3418    1243
## 160              pct_change_dr_fte   numeric   3072    1285
## 161           pct_change_dr_Visits   numeric   3375    1274
## 162       pct_change_Mid_Level_FTE   numeric   2914    1372
## 163    pct_change_Mid_Level_Visits   numeric   3288    1369
## 164           pct_change_nurse_fte   numeric   2786    1505
## 165        pct_change_nurse_visits   numeric   2045    2408
## 166                 pct_change_pts   numeric   3418    1243
## 167             pct_change_Tot_FTE   numeric   3408    1239
## 168         pct_change_Tot_Revenue   numeric   3421    1240
## 169          pct_change_Tot_Visits   numeric   3418    1243
## 170                  Physician_FTE   numeric   1839       0
## 171             Physician_FTE_prev   numeric   1839       0
## 172               Physician_Visits   numeric   4398       0
## 173          Physician_Visits_prev   numeric   4398       0
## 174                     Poverty100   numeric   4031       0
## 175                     Poverty150   numeric   2733       0
## 176                     Poverty200   numeric   1807       0
## 177                 Poverty200over   numeric   1801       0
## 178                 PovertyUnknown   numeric   3259      22
## 179                 PtsbyZipStatus   numeric      3    1131
## 180                      RptStatus   numeric      1       0
## 181                       Same_CEO   numeric      3    1255
## 182                Same_Clinic_Dir   numeric      3    1239
## 183                SEP_Tot_Charges   numeric   4082     402
## 184                    Start_Month character      4       0
## 185                      T3AStatus   numeric      2       0
## 186                      T3BStatus   numeric      2       0
## 187                       T4Status   numeric      2       0
## 188                      T5AStatus   numeric      3    2263
## 189                       T5Status   numeric      2       0
## 190                      T6AStatus   numeric      2       0
## 191                      T6BStatus   numeric      2       0
## 192                       T7Status   numeric      2       0
## 193                      T8AStatus   numeric      2       0
## 194                      T9DStatus   numeric      2       0
## 195                      T9EStatus   numeric      2       0
## 196                 Tot_Allowances   numeric   4534       0
## 197                Tot_Amt_Collect   numeric   4619       0
## 198                Tot_BHPC_Grants   numeric   4582       0
## 199           Tot_BHPC_Grants_prev   numeric   4582       0
## 200                 tot_conditions   numeric     24    2735
## 201                      Tot_Costs   numeric   4651       0
## 202             Tot_Debt_Write_Off   numeric   4030       0
## 203                   Tot_Dent_Pts   numeric   3041       0
## 204                  Tot_Enabl_Pts   numeric   2119       0
## 205                   Tot_Findings   numeric     11     722
## 206                        Tot_FTE   numeric   4151       0
## 207                   Tot_FTE_prev   numeric   4151       0
## 208               Tot_Full_Charges   numeric   4637       0
## 209                    Tot_Med_Pts   numeric   4264       0
## 210                   Tot_Medicaid   numeric   3837       0
## 211                   Tot_Medicare   numeric   2385       0
## 212                   Tot_Ment_Pts   numeric   1715       0
## 213              Tot_NonFed_Grants   numeric   4244       0
## 214              Tot_NonPt_Revenue   numeric   3821       0
## 215             Tot_Oth_Fed_Grants   numeric   3519       0
## 216                    Tot_Penalty   numeric    578       0
## 217                Tot_Private_Ins   numeric   2999       0
## 218                        Tot_Pts   numeric   4341       0
## 219                   tot_pts_prev   numeric   4341       0
## 220                 Tot_Public_Ins   numeric   1123       0
## 221                   Tot_Reconcil   numeric   2270       0
## 222           Tot_Reconcil_Prev_Yr   numeric   2597       0
## 223                Tot_Retroactive   numeric   1131       0
## 224                    Tot_Revenue   numeric   4648       0
## 225               Tot_Revenue_prev   numeric   4648       0
## 226           Tot_Sliding_Discount   numeric   4578       0
## 227                  Tot_Uninsured   numeric   3811       0
## 228                     Tot_Visits   numeric   4579       0
## 229                Tot_Visits_prev   numeric   4579       0
## 230                Tot_w_Donations   numeric   4651       0
## 231           Total_Charged_Amount   numeric   3670     402
## 232                 Type_Performer   numeric      3    4629
## 233                     UrbanRural   numeric      3    1132
## 234                           year   numeric      4       0
{% endhighlight %}

### Missing Data

Only 89 of 243 variables contain no missing data.

{% highlight r %}
sum(a$missing==0)
{% endhighlight %}



{% highlight text %}
## [1] 89
{% endhighlight %}

The variables that are missing some data range from under 1% to 99% missing.  The 31 variables missing with more than 80% NAs will likely be difficult to use.  However, there are a decent amount of variables missing ~25%.

{% highlight r %}
sum(a$missing/nrow(d)>0.8)
{% endhighlight %}



{% highlight text %}
## [1] 31
{% endhighlight %}



{% highlight r %}
hist(a$missing/nrow(d), xlab='% missing data', breaks=30, main='Distribution of NAs in variables')
{% endhighlight %}

![plot of chunk unnamed-chunk-4](/simpleblog/assets/Rfig/unnamed-chunk-4-1.svg) 

